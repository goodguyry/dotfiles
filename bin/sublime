#!/bin/bash
# Installs Sublime Text packages and settings


DOTFILES_DIRECTORY="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && cd .. && pwd )";


# Clone a Sublime Text 3 package repo to Packages directory
function add_sublime_package() {
  local REPO="${1}"
  local PACKAGE="${2}";
  if [[ ! -d "${SUBLIME_PACKAGES}/${PACKAGE}" ]]; then
    log_header "Cloning ${PACKAGE}";
    git clone "${REPO}" "${SUBLIME_PACKAGES}/${PACKAGE}"  &> /dev/null;
    [[ $? ]] && log_success "${PACKAGE} installed."
  else
    log_header "${PACKAGE} already exists...";
  fi;
}


# Clone packages
log_header 'Adding Sublime Text packages...';

add_sublime_package 'git@github.com:daylerees/colour-schemes.git'                   'ColourSchemes';
add_sublime_package 'git@github.com:y0ssar1an/CSS3.git'                             'CSS3';
add_sublime_package 'git@github.com:spadgos/sublime-jsdocs.git'                     'DocBlockr';
add_sublime_package 'git@github.com:sindresorhus/editorconfig-sublime.git'          'EditorConfig';
add_sublime_package 'git@github.com:colinta/SublimeFileDiffs.git'                   'FileDiffs';
add_sublime_package 'git@github.com:kemayo/sublime-text-git.git'                    'Git';
add_sublime_package 'git@github.com:jisaacks/GitGutter.git'                         'GitGutter';
add_sublime_package 'git@github.com:siteleaf/liquid-syntax-mode.git'                'LiquidSyntax';
add_sublime_package 'git@github.com:braver/MarkdownHighlighting.git'                'MarkdownHighlighting';
add_sublime_package 'git@github.com:titoBouzout/SideBarEnhancements.git'            'SideBarEnhancements';
add_sublime_package 'https://github.com/lamotta/specialsboard.git'                  'SpecialsBoard';
add_sublime_package 'git@github.com:P233/Syntax-highlighting-for-Sass.git'          'SyntaxHighlightingForSass';

log_success 'Sublime Text packages installed.'
log_warning 'Install Package Control: https://packagecontrol.io/installation'
log_warning 'Install Markdown Preview with Package Control'


# Set Sublime Text settings directory
SUBLIME_PACKAGES="${HOME}/Library/Application Support/Sublime Text 3/Packages";

# Create the directory path if it doesn't exist
[[ ! -d "${SUBLIME_PACKAGES}/User" ]] && mkdir -p "${SUBLIME_PACKAGES}/User";


# Sublime Text settings
set_file \
  'sublime/Default (OSX).sublime-keymap' \
  "${SUBLIME_PACKAGES}/User/Default (OSX).sublime-keymap";

set_file \
  'sublime/Markdown.sublime-settings' \
  "${SUBLIME_PACKAGES}/User/Markdown.sublime-settings";

set_file \
  'sublime/Preferences.sublime-settings' \
  "${SUBLIME_PACKAGES}/User/Preferences.sublime-settings";

set_file \
  'sublime/Ruby.sublime-settings' \
  "${SUBLIME_PACKAGES}/User/Ruby.sublime-settings";

set_file \
  'sublime/Shell-Unix-Generic.sublime-settings' \
  "$SUBLIME_PACKAGES/User/Shell-Unix-Generic.sublime-settings";


[[ $? ]] && log_success 'Sublime settings done.'
